---
id: acquisition
title: Acquisition
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

# Acquisition

By default when CrowdSec is installed it will attempt to detect the running services and acquire the appropriate parsers and scenarios.

However, we should check that this detection worked or you may want to manually acquire parsers and scenarios for services that are not detected.

## What services are already detected?

To find what services are already detected, you can use the `cscli` command line tool.

```bash
cscli collections list
```

:::info
Collections are packages of parsers and scenarios that are used to detect security threats.
:::

### How to interpret the output

The output will show a list of collections that are already installed. For example `crowdsecurity/sshd` is the collection for the `sshd` service.

## Are the detected services working correctly?

To check if the detected services are working correctly, you can use the `cscli` command line tool.

```bash
cscli collections inspect <collection_name>
```

### How to interpret the output

Within the output, you will see a list of parsers and scenarios that are installed for the collection. If you see the correct files for your platform and version, and the parsed count is above `0` it most likely means collection is working as intended.

<details>

<summary>Example output</summary>

```bash title="See highlighted lines at bottom"
type: collections
name: crowdsecurity/iptables
file_name: iptables.yaml
description: 'iptables support : logs and port-scans detection scenarios'
author: crowdsecurity
path: collections/crowdsecurity/iptables.yaml
version: "0.2"
parsers:
- crowdsecurity/iptables-logs
scenarios:
- crowdsecurity/iptables-scan-multi_ports
contexts:
- crowdsecurity/firewall_base
local_path: /etc/crowdsec/collections/iptables.yaml
local_version: "0.2"
local_hash: d59e4198c2b88cccb6f9da9f9375348a1835d7f5a933d7452693ad0321ef1282
installed: true
downloaded: true
uptodate: true
tainted: false
belongs_to_collections:
- crowdsecurity/unifi
local: false

# highlight-start
Current metrics:

- (Parser) crowdsecurity/iptables-logs:
╭────────────────────────┬──────┬────────┬──────────╮
│        Parsers         │ Hits │ Parsed │ Unparsed │
├────────────────────────┼──────┼────────┼──────────┤
│ file:/var/log/kern.log │ 45   │ 45     │ 0        │
├────────────────────────┼──────┼────────┼──────────┤
│ file:/var/log/syslog   │ 45   │ 45     │ 0        │
╰────────────────────────┴──────┴────────┴──────────╯

- (Scenario) crowdsecurity/iptables-scan-multi_ports:
╭───────────────┬───────────┬──────────────┬────────┬─────────╮
│ Current Count │ Overflows │ Instantiated │ Poured │ Expired │
├───────────────┼───────────┼──────────────┼────────┼─────────┤
│ 0             │ 0         │ 38           │ 38     │ 38      │
╰───────────────┴───────────┴──────────────┴────────┴─────────╯
# highlight-end
```

</details>

Within the output if the bottom section is blank or the parsed count is `0` then you may need to perform additional checks on the configuration. Follow the [how to setup a new acquisition](#how-to-setup-a-new-acquisition) section which will walk you through the steps to add a new acquisition.

## What services are supported?

To find a list of supported services, you can [browse the hub online](https://hub.crowdsec.net/) or use the `cscli` command line tool.

```bash
cscli collections list --all
```

:::tip
You can filter the output by piping the output using command line tools such as `grep` or `awk`.
:::

## Next steps?

If you already see all services you want covered by the previous commands then you can [head back to the post installation guide.](/getting_started/next_steps.md)

However, if there is a service you wish to cover that is already covered by the [Hub](https://hub.crowdsec.net/) then follow the next steps.

## How to setup a new acquisition

Once you have found service you want to add, you can use the `cscli` command line tool to add the collection.

:::info
We will be adding a [file based acquisition](/docs/next/data_sources/file). If you need to use a different source then alter the instructions to match your needs.
:::

```bash
cscli collections add <collection_name>
```

Once the collection has been downloaded we need to add a new acquisition to the configuration.

:::info
From version `1.5.0` we have added the ability to add acquisitions via the `acquis.d` directory. This allows you to add acquisitions without modifying the main configuration file.
:::

### Create the directory if it does not exist

<Tabs
  defaultValue="nix"
  groupId="console-operating-systems"
  values={[
    {label: 'Linux/Freebsd', value: 'nix'},
    {label: 'Windows', value: 'windows'},
  ]}>
  <TabItem value="nix">
    <CodeBlock className="language-bash">sudo mkdir -p /etc/crowdsec/acquis.d</CodeBlock>
  </TabItem>
  <TabItem value="windows">
        <Tabs
    defaultValue="powershell"
    groupId="windows-terminal"
    values={[
      {label: 'Powershell', value: 'powershell'},
      {label: 'CMD', value: 'terminal'},
    ]}>
      <TabItem value="powershell">
          ```bash
          New-Item -ItemType Directory -Force -Path C:\ProgramData\CrowdSec\Config\acquis.d\
          ```
      </TabItem>
      <TabItem value="terminal">
          ```bash
          mkdir "C:\ProgramData\CrowdSec\Config\acquis.d\"
          ```
      </TabItem>
    </Tabs>
  </TabItem>
</Tabs>

### Create the acquisition file

<Tabs
  defaultValue="nix"
  groupId="console-operating-systems"
  values={[
    {label: 'Linux/Freebsd', value: 'nix'},
    {label: 'Windows', value: 'windows'},
  ]}>
  <TabItem value="nix">
    ```bash
    sudo touch /etc/crowdsec/acquis.d/<collection_name>.yaml
    ```
  </TabItem>
  <TabItem value="windows">
        <Tabs
    defaultValue="powershell"
    groupId="windows-terminal"
    values={[
      {label: 'Powershell', value: 'powershell'},
      {label: 'CMD', value: 'terminal'},
    ]}>
      <TabItem value="powershell">
          ```bash
          New-Item -ItemType File -Force -Path C:\ProgramData\CrowdSec\Config\acquis.d\<collection_name>.yaml
          ```
      </TabItem>
      <TabItem value="terminal">
          ```bash
          .>C:\ProgramData\CrowdSec\Config\acquis.d\<collection_name>.yaml 2>NUL
          ```
      </TabItem>
    </Tabs>
  </TabItem>
</Tabs>

### Add the following contents to the file

```yaml title="<collection_name>.yaml"
filesnames:
  - "/path/to/your/file.log" ## Single file
  - "/path/to/your/files*" ## Wildcard support
labels:
  type: "<type of logs>" ## Type defined in the parser
```

:::tip
You can find an example acquisition within the collection shown on the [hub](https://hub.crowdsec.net/), this will help you understand what files you need to monitor and what labels you need to add.
:::

Once you have added the acquisitions you can test the configuration and restart the service.

<Tabs
  defaultValue="nix"
  groupId="console-operating-systems"
  values={[
    {label: 'Linux/Freebsd', value: 'nix'},
    {label: 'Windows', value: 'windows'},
  ]}>
  <TabItem value="nix">
    ```bash
    sudo crowdsec -t && sudo systemctl restart crowdsec
    ```
  </TabItem>
  <TabItem value="windows">
      <Tabs
    defaultValue="powershell"
    groupId="windows-terminal"
    values={[
      {label: 'Powershell', value: 'powershell'},
      {label: 'CMD', value: 'terminal'},
    ]}>
      <TabItem value="powershell">
          ```bash
          Restart-Service crowdsec
          ```
      </TabItem>
      <TabItem value="terminal">
          ```bash
          net stop crowdsec && net start crowdsec
          ```
      </TabItem>
    </Tabs>
  </TabItem>
</Tabs>
